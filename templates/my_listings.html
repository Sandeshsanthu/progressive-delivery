{% extends "base.html" %}
{% block content %}

<div style="display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px;">
  <h1 style="margin:0;">My Listings</h1>
  <a class="btn btn-primary" href="{{ url_for('new_listing') }}">New listing</a>
</div>

{% if not listings %}
  <p>You have no listings yet.</p>
{% else %}
  <div style="display:grid; gap:12px;">
    {% for listing in listings %}
      <div class="card" style="padding:12px;">
        <h2 style="margin:0 0 6px 0;">{{ listing["title"] }}</h2>
        <div style="color:#666; margin-bottom:8px;">
          {{ listing["make"] }} {{ listing["model"] }} • {{ listing["year"] }} • {{ listing["mileage"] }} mi
        </div>
        <div style="margin-bottom:8px;">
          <strong>{{ listing["currency"] }} {{ (listing["price_cents"]|int / 100) | round(2) }}</strong>
          <span style="margin-left:10px;">Status: {{ listing["status"] }}</span>
        </div>

        <div style="display:flex; gap:8px; flex-wrap:wrap;">
          <a class="btn btn-secondary" href="{{ url_for('listing_detail', listing_id=listing['id']) }}">View</a>
          <a class="btn btn-secondary" href="{{ url_for('edit_listing', listing_id=listing['id']) }}">Edit</a>

          {% if listing["status"] != "SOLD" %}
          <form method="post" action="{{ url_for('mark_sold', listing_id=listing['id']) }}">
            <button class="btn btn-warning" type="submit">Mark sold</button>
          </form>
          {% endif %}

          <form method="post" action="{{ url_for('delete_listing', listing_id=listing['id']) }}" onsubmit="return confirm('Delete this listing?');">
            <button class="btn btn-danger" type="submit">Delete</button>
          </form>
        </div>
      </div>
    {% endfor %}
  </div>
{% endif %}

{% endblock %}


